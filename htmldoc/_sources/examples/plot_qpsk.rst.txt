
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "examples/plot_qpsk.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download_examples_plot_qpsk.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_examples_plot_qpsk.py:


QPSK modulation
===============

.. GENERATED FROM PYTHON SOURCE LINES 7-9

Main libraries import
---------------------

.. GENERATED FROM PYTHON SOURCE LINES 9-17

.. code-block:: default


    import numpy as np
    from numpy import log10, sqrt, pi
    from matplotlib import pyplot as plt

    from blocksim import logger
    from blocksim.dsp.PSKMod import PSKMapping, PSKDemapping








.. GENERATED FROM PYTHON SOURCE LINES 18-20

Instanciation of QPSK modulator and demodulator
-----------------------------------------------

.. GENERATED FROM PYTHON SOURCE LINES 20-25

.. code-block:: default


    mapping = [pi / 4, 3 * pi / 4, 5 * pi / 4, 7 * pi / 4]
    qpsk_co = PSKMapping(name="map", mapping=mapping, output_size=1)
    qpsk_dec = PSKDemapping(name="demap", mapping=mapping, output_size=2)








.. GENERATED FROM PYTHON SOURCE LINES 26-27

Generation of a random bitstream

.. GENERATED FROM PYTHON SOURCE LINES 27-31

.. code-block:: default


    ntot = 256
    data = np.random.randint(low=0, high=2, size=(qpsk_co.mu, ntot))








.. GENERATED FROM PYTHON SOURCE LINES 32-33

Generation of the QPSK stream of symbols

.. GENERATED FROM PYTHON SOURCE LINES 33-36

.. code-block:: default


    qpsk_payload = qpsk_co.process(data)








.. GENERATED FROM PYTHON SOURCE LINES 37-38

Adding gaussian noise to the QPSK stream of symbols

.. GENERATED FROM PYTHON SOURCE LINES 38-44

.. code-block:: default


    n = qpsk_payload.shape
    qpsk_payload += (np.random.normal(size=n) + 1j * np.random.normal(size=n)) * sqrt(
        0.05 / 2
    )








.. GENERATED FROM PYTHON SOURCE LINES 45-47

Demodulation of the noisy QPSK symbols stream
and verification of the error

.. GENERATED FROM PYTHON SOURCE LINES 47-54

.. code-block:: default


    m = qpsk_dec.process(qpsk_payload)
    err = np.abs(m - data)
    inok = np.where(err == 1)[0]
    ber = len(inok) / ntot
    print("BER : %.1f%%" % (ber * 100))





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    BER : 0.0%




.. GENERATED FROM PYTHON SOURCE LINES 55-57

Plotting
--------

.. GENERATED FROM PYTHON SOURCE LINES 57-73

.. code-block:: default


    fig = plt.figure()
    axe = fig.add_subplot(111)
    axe.grid(True)
    axe.set_aspect("equal")
    axe.scatter(
        np.real(qpsk_payload),
        np.imag(qpsk_payload),
        color="blue",
        marker="+",
        label="RX symbols",
    )
    qpsk_co.plotConstellation(axe)
    axe.legend(loc="best")

    plt.show()



.. image-sg:: /examples/images/sphx_glr_plot_qpsk_001.png
   :alt: plot qpsk
   :srcset: /examples/images/sphx_glr_plot_qpsk_001.png
   :class: sphx-glr-single-img






.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 0 minutes  0.110 seconds)


.. _sphx_glr_download_examples_plot_qpsk.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example



  .. container:: sphx-glr-download sphx-glr-download-python

     :download:`Download Python source code: plot_qpsk.py <plot_qpsk.py>`



  .. container:: sphx-glr-download sphx-glr-download-jupyter

     :download:`Download Jupyter notebook: plot_qpsk.ipynb <plot_qpsk.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
